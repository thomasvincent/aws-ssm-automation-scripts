{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://example.com/ssm-automation.schema.json",
  "title": "AWS SSM Automation Document (minimal)",
  "type": "object",
  "required": ["description", "schemaVersion", "parameters", "mainSteps"],
  "additionalProperties": true,
  "properties": {
    "description": { "type": "string", "minLength": 1 },
    "schemaVersion": { "type": "string", "const": "0.3" },
    "assumeRole": { "type": "string" },
    "parameters": {
      "type": "object",
      "additionalProperties": { "$ref": "#/definitions/ParameterDef" }
    },
    "mainSteps": {
      "type": "array",
      "minItems": 1,
      "items": { "$ref": "#/definitions/MainStep" }
    }
  },
  "definitions": {
    "ParameterDef": {
      "type": "object",
      "required": ["type"],
      "additionalProperties": true,
      "properties": {
        "type": {
          "type": "string",
          "enum": ["String", "StringList", "Integer", "Boolean", "StringMap"]
        },
        "description": { "type": "string" },
        "default": {},
        "allowedValues": { "type": "array" },
        "minValue": { "type": "integer" },
        "maxValue": { "type": "integer" }
      }
    },
    "MainStep": {
      "type": "object",
      "required": ["name", "action"],
      "additionalProperties": true,
      "properties": {
        "name": { "type": "string", "minLength": 1 },
        "action": { "type": "string", "pattern": "^aws:[a-zA-Z]+" },
        "onFailure": { "type": "string" },
        "inputs": { "type": "object" },
        "outputs": { "type": "array" },
        "isEnd": { "type": "boolean" }
      }
    }
  }
}
